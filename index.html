<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Formulario iD Myself – HOYALUX</title>

<style>
/* ===== A4 y reset impresión ===== */
@page { size: A4; margin: 12mm }
html,body{height:100%}
body{
  margin:0;
  background:#eef2ff;
  font-family: ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
}

/* ===== Paleta ===== */
:root{
  --hoya-navy:#0b3d91;
  --hoya-navy-ink:#0a2d6f;
  --ink:#0f172a;
  --muted:#475569;
  --rose:#f7ecf5;
  --rose-border:#ead7e7;
  --accent:#7a2b6c;
  --ok:#13c18d;
  --ok-ink:#0a654d;
}

/* ===== Barra superior: orden + botones ===== */
.topbar{
  position: sticky; top:0; z-index:30;
  background:var(--hoya-navy);
  padding:16px 0 20px;
  box-shadow:0 6px 16px rgba(2,6,23,.18);
}
.wrap{
  width:210mm; max-width:100%; margin:0 auto; padding:0 12mm;
}
.order-row{
  display:flex; align-items:center; gap:14px;
  background:rgba(255,255,255,.08);
  color:#e6eefc; border-radius:12px; padding:12px 14px;
}
.order-row .lbl{ font-weight:800; opacity:.9; min-width:98px }
.order-pill{
  display:inline-flex; align-items:center; gap:10px;
  background:#5a91f0; color:#fff; padding:10px 16px;
  border-radius:12px; font-weight:900; letter-spacing:.3px;
  min-width:280px; justify-content:center;
}
.order-pill.ok{ background:var(--ok); color:#fff; }
.order-status{
  display:inline-flex; align-items:center; gap:8px; opacity:.9
}
.order-status .check{
  width:16px; height:16px; border-radius:50%;
  border:2px solid #cbe6ff; display:inline-block;
  position:relative;
}
.order-status.ok .check{
  border-color:#d1fae5;
}
.order-status.ok .check::after{
  content:""; position:absolute; left:3px; top:0px;
  width:8px; height:14px; border-right:3px solid #d1fae5; border-bottom:3px solid #d1fae5;
  transform:rotate(40deg);
}

/* botones */
.btn{
  background:#fff; color:var(--hoya-navy);
  border:0; padding:12px 18px; border-radius:10px;
  font-weight:800; cursor:pointer;
  box-shadow: 0 2px 0 rgba(0,0,0,.15) inset;
  transition: transform .02s ease-in-out;
}
.btn:active{ transform: translateY(1px) }
.btn:disabled{opacity:.6;cursor:not-allowed}
.btn-ghost{
  background:transparent; color:#fff; border:2px solid #fff;
}
.top-actions{
  display:flex; justify-content:center; gap:14px; margin-top:14px;
}

/* ===== Hoja ===== */
.sheet{ width:210mm; margin:0 auto; }
.page{
  background:#fff;
  box-shadow:0 10px 28px rgba(15,23,42,.15);
  margin:10mm 0;
  padding:0;
}

/* ===== Hero ===== */
.hero{
  position:relative;
  width: 210mm;
  height: 73mm;              /* puedes bajar a 65–70mm para “menos ancho visual” */
  margin: 0 auto;
  background:#ddd url('idmyself_header.jpg') center/cover no-repeat;
}
.hero .band{
  position:absolute; left:0; right:0; bottom:8mm;
  display:flex; justify-content:center;
}
.hero .title{
  background:var(--hoya-navy);
  color:#fff; font-weight:900; letter-spacing:.04em;
  padding:10px 20px; border-radius:8px;
  box-shadow:0 10px 22px rgba(2,6,23,.25);
}

/* ===== Secciones ===== */
.section{ padding:10mm 12mm 6mm }
.section h3{
  margin:0 0 6mm; color:#6d1c5e; letter-spacing:.2px;
  font-size:13.5px; display:flex; align-items:center; gap:8px;
}
.section h3::before{
  content:""; width:12px; height:12px; border-radius:3px; background:var(--hoya-navy);
}

/* ===== Panel azul (información personal) ===== */
.personal{
  background:var(--hoya-navy); color:#e6eefc;
  border-radius:10px; padding:10mm 12mm;
  --g:22px; background-image:
    linear-gradient(rgba(255,255,255,.08) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,.08) 1px, transparent 1px);
  background-size:var(--g) var(--g), var(--g) var(--g);
}
.personal h3{color:#fff}
.personal h3::before{background:#fff}
.personal label{color:#e6eefc}
.grid{display:grid; gap:10px 14px}
.col-6{grid-column:span 6}
.col-4{grid-column:span 4}
.col-8{grid-column:span 8}
.input, .line{
  width:100%; height:26px;
  border:none; border-bottom:1.5px solid rgba(255,255,255,.75);
  background:transparent; color:#fff; font:inherit;
}
.input::placeholder, .line::placeholder{ color:#dce7ff }
.radio-row{ display:flex; gap:14px; align-items:center }

/* ===== Caja rosada ===== */
.soft .input, .soft .line{
  background:var(--rose); color:var(--ink);
  border:1px solid var(--rose-border);
  border-radius:6px; height:28px; padding:0 8px;
}
label{font-size:12px; color:var(--muted); display:block}

/* ===== Dos columnas grandes ===== */
.two{display:grid; grid-template-columns: 1fr 1fr; gap:12mm}

/* ===== Chips (radios) ===== */
.chips{display:flex; flex-wrap:wrap; gap:6px}
.chip{
  border:1px solid #e2e8f0; border-radius:999px;
  padding:4px 10px; font-size:11.5px; color:#111; cursor:pointer;
  display:inline-flex; align-items:center; gap:6px;
}
.chip input{ appearance:none; width:0; height:0; margin:0 }
.chip:has(input:checked){
  background:var(--rose); border-color:#e7cfe0; color:var(--accent);
}

/* ===== Banner azul intermedio con fotos ===== */
.banner{ height:32mm; background:var(--hoya-navy) }
.banner img{ width:100%; height:100%; object-fit:cover; opacity:.9 }

/* ===== Tabla 0–5 ===== */
.table{ border-collapse:collapse; width:100%; font-size:11.5px }
.table th,.table td{ border:1px solid #eef2ff; padding:6px 8px; vertical-align:top }
.table th{ background:#f8fafc; color:#334155; font-weight:800 }

/* ==== Arreglo de tabla de Importancia (espaciado/anchos) ==== */
.table.imp { 
  table-layout: fixed;
  width: 100%;
  border-collapse: collapse;
  font-size: 11.5px;
}
.table.imp col.col-act     { width: 34%; }
.table.imp col.col-score   { width: 6%;  }
.table.imp col.col-details { width: 30%; }
.table.imp th,.table.imp td{
  border:1px solid #eef2ff; padding:8px 6px; vertical-align:middle; background:#fff
}
.table.imp th{ background:#f8fafc; color:#334155; font-weight:800; white-space:nowrap }
.table.imp td.center { text-align:center }
.table.imp input[type="radio"]{ transform:scale(1.05) }
.table.imp .chips.flow{ display:flex; flex-wrap:wrap; gap:8px }
.table.imp .chips.flow .chip{ margin:2px 0 }

/* ===== Logos al pie de cada página ===== */
.foot-logos{
  display:flex; justify-content:space-between; align-items:center;
  padding:8mm 12mm 10mm;
}
.foot-logos img{ height:16mm }

/* Romper a la página siguiente */
.page-break{ page-break-before:always }

/* Ocultar elementos pantalla al imprimir (opcional) */
@media print{
  .topbar{display:none}
  .page{box-shadow:none; margin:0}
}
</style>
</head>
<body>

<!-- ======= Barra superior con número de orden + acciones ======= -->
<div class="topbar">
  <div class="wrap">
    <div class="order-row">
      <div class="lbl">Nº de orden</div>
      <div id="orderPill" class="order-pill">—</div>
      <div id="orderStatus" class="order-status"><span class="check"></span> Orden pendiente</div>
    </div>

    <div class="top-actions">
      <button id="sendBtn" class="btn" onclick="sendAndPrint(event)">Enviar orden a Trimax y Descargar DOC</button>
      <button class="btn btn-ghost" onclick="newOrder(event)">Generar nueva orden</button>
    </div>
  </div>
</div>

<form id="hoyaForm" class="sheet">

  <!-- ============ PÁGINA 1 ============ -->
  <section class="page">

    <!-- Hero -->
    <div class="hero">
      <div class="band"><div class="title">FORMULARIO IDENTIFIER · iD MYSELF · HOYALUX</div></div>
    </div>

    <!-- Información personal (panel azul) -->
    <div class="section personal">
      <h3>INFORMACIÓN PERSONAL</h3>
      <div class="grid" style="grid-template-columns: repeat(12, 1fr);">
        <!-- Nombre del cliente (mantiene name="sistema" para la hoja) -->
        <div class="col-6">
          <label>Nombre del cliente</label>
          <input class="line" name="sistema" placeholder="Nombre del cliente" />
        </div>
        <div class="col-6"></div>

        <div class="col-6">
          <label>Nombre</label>
          <input class="line" name="nombre" />
        </div>
        <div class="col-6">
          <label>Apellidos</label>
          <input class="line" name="apellidos" />
        </div>

        <div class="col-4">
          <label>Sexo</label>
          <div class="radio-row">
            <label class="chip"><input type="radio" name="sexo" value="Masculino"><span>Masculino</span></label>
            <label class="chip"><input type="radio" name="sexo" value="Femenino"><span>Femenino</span></label>
          </div>
        </div>
        <div class="col-8">
          <label>Fecha de nacimiento</label>
          <input class="line" name="fecha_nac" type="date" />
        </div>
      </div>
    </div>

    <!-- Prescripción -->
    <div class="section">
      <h3>PRESCRIPCIÓN</h3>
      <div class="two soft">
        <!-- Ojo izquierdo -->
        <div>
          <div style="font-weight:700;color:#7a2b6c;margin-bottom:6px">Ojo izquierdo</div>
          <label>Esférico</label><input class="input" name="esf_oi">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div><label>Cilíndrico</label><input class="input" name="cil_oi"></div>
            <div><label>Eje</label><input class="input" name="eje_oi"></div>
          </div>

          <label>Adición</label><input class="input" name="adic_oi">

          <label>Prisma</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="prisma_oi" value="Si"><span>Sí</span></label>
            <label class="chip"><input type="radio" name="prisma_oi" value="No"><span>No</span></label>
          </div>

          <!-- Prisma OI (horizontal / vertical con chips Nasal/Temporal) -->
          <div style="margin-top:8px;display:grid;grid-template-columns:1fr auto auto;gap:10px;align-items:end">
            <div><label>Horizontal (valor)</label><input class="input" name="prisma_h_oi_val"></div>
            <label class="chip"><input type="radio" name="horiz_oi" value="Nasal"><span>Nasal</span></label>
            <label class="chip"><input type="radio" name="horiz_oi" value="Temporal"><span>Temporal</span></label>
          </div>
          <div style="margin-top:8px;display:grid;grid-template-columns:1fr auto auto;gap:10px;align-items:end">
            <div><label>Vertical (valor)</label><input class="input" name="prisma_v_oi_val"></div>
            <label class="chip"><input type="radio" name="vert_oi" value="Nasal"><span>Nasal</span></label>
            <label class="chip"><input type="radio" name="vert_oi" value="Temporal"><span>Temporal</span></label>
          </div>
          <label style="margin-top:8px">Resultado</label><input class="input" name="prisma_res_oi">
        </div>

        <!-- Ojo derecho -->
        <div>
          <div style="font-weight:700;color:#7a2b6c;margin-bottom:6px">Ojo derecho</div>
          <label>Esférico</label><input class="input" name="esf_od">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div><label>Cilíndrico</label><input class="input" name="cil_od"></div>
            <div><label>Eje</label><input class="input" name="eje_od"></div>
          </div>

          <label>Adición</label><input class="input" name="adic_od">

          <label>Primer par de lentes</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="primer_par" value="Si"><span>Sí</span></label>
            <label class="chip"><input type="radio" name="primer_par" value="No"><span>No</span></label>
          </div>

          <!-- Prisma OD -->
          <div style="margin-top:8px;display:grid;grid-template-columns:1fr auto auto;gap:10px;align-items:end">
            <div><label>Horizontal (valor)</label><input class="input" name="prisma_h_od_val"></div>
            <label class="chip"><input type="radio" name="horiz_od" value="Nasal"><span>Nasal</span></label>
            <label class="chip"><input type="radio" name="horiz_od" value="Temporal"><span>Temporal</span></label>
          </div>
          <div style="margin-top:8px;display:grid;grid-template-columns:1fr auto auto;gap:10px;align-items:end">
            <div><label>Vertical (valor)</label><input class="input" name="prisma_v_od_val"></div>
            <label class="chip"><input type="radio" name="vert_od" value="Nasal"><span>Nasal</span></label>
            <label class="chip"><input type="radio" name="vert_od" value="Temporal"><span>Temporal</span></label>
          </div>
          <label style="margin-top:8px">Resultado</label><input class="input" name="prisma_res_od">
        </div>
      </div>
    </div>

    <!-- Estilo de vida -->
    <div class="section">
      <h3>ESTILO DE VIDA · ¿Dónde pasas el día?</h3>
      <div style="display:grid;grid-template-columns:1fr;gap:10px" class="soft">
        <div>
          <label>Ambientes interiores</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="int" value="0%"><span>0%</span></label>
            <label class="chip"><input type="radio" name="int" value="10%"><span>10%</span></label>
            <label class="chip"><input type="radio" name="int" value="20%"><span>20%</span></label>
            <label class="chip"><input type="radio" name="int" value="30%"><span>30%</span></label>
            <label class="chip"><input type="radio" name="int" value="40%"><span>40%</span></label>
            <label class="chip"><input type="radio" name="int" value="50%"><span>50%</span></label>
            <label class="chip"><input type="radio" name="int" value="60%"><span>60%</span></label>
            <label class="chip"><input type="radio" name="int" value="70%"><span>70%</span></label>
            <label class="chip"><input type="radio" name="int" value="80%"><span>80%</span></label>
            <label class="chip"><input type="radio" name="int" value="90%"><span>90%</span></label>
            <label class="chip"><input type="radio" name="int" value="100%"><span>100%</span></label>
          </div>
        </div>
        <div>
          <label>Ambientes exteriores</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="ext" value="0%"><span>0%</span></label>
            <label class="chip"><input type="radio" name="ext" value="10%"><span>10%</span></label>
            <label class="chip"><input type="radio" name="ext" value="20%"><span>20%</span></label>
            <label class="chip"><input type="radio" name="ext" value="30%"><span>30%</span></label>
            <label class="chip"><input type="radio" name="ext" value="40%"><span>40%</span></label>
            <label class="chip"><input type="radio" name="ext" value="50%"><span>50%</span></label>
            <label class="chip"><input type="radio" name="ext" value="60%"><span>60%</span></label>
            <label class="chip"><input type="radio" name="ext" value="70%"><span>70%</span></label>
            <label class="chip"><input type="radio" name="ext" value="80%"><span>80%</span></label>
            <label class="chip"><input type="radio" name="ext" value="90%"><span>90%</span></label>
            <label class="chip"><input type="radio" name="ext" value="100%"><span>100%</span></label>
          </div>
        </div>
      </div>
    </div>

    <div class="banner"><img src="idmyself_actividades.jpg" alt=""></div>

    <div class="foot-logos">
      <img src="Imagen_Hoya.jpg" alt="HOYA">
      <img src="Imagen_tecnologia.jpg" alt="Tecnología japonesa">
    </div>

  </section>

  <!-- ============ PÁGINA 2 ============ -->
  <section class="page page-break">

    <!-- Clasificación de actividades -->
    <div class="section">
      <h3>CLASIFICACIÓN DE IMPORTANCIA DE CADA ACTIVIDAD · 0 = poco importante, 5 = muy importante</h3>

      <table class="table imp">
        <colgroup>
          <col class="col-act">
          <col class="col-score"><col class="col-score"><col class="col-score">
          <col class="col-score"><col class="col-score"><col class="col-score">
          <col class="col-details">
        </colgroup>
        <thead>
          <tr>
            <th>Actividad</th>
            <th>0</th><th>1</th><th>2</th><th>3</th><th>4</th><th>5</th>
            <th>Detalles</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Viendo televisión</td>
            <td class="center"><input type="radio" name="tv" value="0"></td>
            <td class="center"><input type="radio" name="tv" value="1"></td>
            <td class="center"><input type="radio" name="tv" value="2"></td>
            <td class="center"><input type="radio" name="tv" value="3"></td>
            <td class="center"><input type="radio" name="tv" value="4"></td>
            <td class="center"><input type="radio" name="tv" value="5"></td>
            <td></td>
          </tr>

          <tr>
            <td>Hacer compras</td>
            <td class="center"><input type="radio" name="compras" value="0"></td>
            <td class="center"><input type="radio" name="compras" value="1"></td>
            <td class="center"><input type="radio" name="compras" value="2"></td>
            <td class="center"><input type="radio" name="compras" value="3"></td>
            <td class="center"><input type="radio" name="compras" value="4"></td>
            <td class="center"><input type="radio" name="compras" value="5"></td>
            <td></td>
          </tr>

          <tr>
            <td>Conducir</td>
            <td class="center"><input type="radio" name="drive" value="0"></td>
            <td class="center"><input type="radio" name="drive" value="1"></td>
            <td class="center"><input type="radio" name="drive" value="2"></td>
            <td class="center"><input type="radio" name="drive" value="3"></td>
            <td class="center"><input type="radio" name="drive" value="4"></td>
            <td class="center"><input type="radio" name="drive" value="5"></td>
            <td>
              <div class="chips flow">
                <label class="chip"><input type="checkbox" name="drive_auto"><span>Auto</span></label>
                <label class="chip"><input type="checkbox" name="drive_bus"><span>Autobús</span></label>
                <label class="chip"><input type="checkbox" name="drive_moto"><span>Moto</span></label>
                <label class="chip"><input type="checkbox" name="drive_tren"><span>Tren</span></label>
                <label class="chip"><input type="checkbox" name="drive_camion"><span>Camión</span></label>
              </div>
            </td>
          </tr>

          <tr>
            <td>Vida profesional</td>
            <td class="center"><input type="radio" name="vida" value="0"></td>
            <td class="center"><input type="radio" name="vida" value="1"></td>
            <td class="center"><input type="radio" name="vida" value="2"></td>
            <td class="center"><input type="radio" name="vida" value="3"></td>
            <td class="center"><input type="radio" name="vida" value="4"></td>
            <td class="center"><input type="radio" name="vida" value="5"></td>
            <td>
              <div class="chips flow">
                <label class="chip"><input type="checkbox" name="work_cerca"><span>Cerca</span></label>
                <label class="chip"><input type="checkbox" name="work_inter_cercano"><span>Intermedio y cercano</span></label>
                <label class="chip"><input type="checkbox" name="work_inter_laboral"><span>Intermedio laboral</span></label>
                <label class="chip"><input type="checkbox" name="work_lejos"><span>Lejos</span></label>
                <label class="chip"><input type="checkbox" name="work_inter_lejano"><span>Intermedio y lejano</span></label>
              </div>
            </td>
          </tr>

          <tr>
            <td>Deportes y recreación</td>
            <td class="center"><input type="radio" name="sport" value="0"></td>
            <td class="center"><input type="radio" name="sport" value="1"></td>
            <td class="center"><input type="radio" name="sport" value="2"></td>
            <td class="center"><input type="radio" name="sport" value="3"></td>
            <td class="center"><input type="radio" name="sport" value="4"></td>
            <td class="center"><input type="radio" name="sport" value="5"></td>
            <td>
              <div class="chips flow">
                <label class="chip"><input type="checkbox" name="sport_gimnasia"><span>Gimnasia</span></label>
                <label class="chip"><input type="checkbox" name="sport_correr"><span>Correr y caminar</span></label>
                <label class="chip"><input type="checkbox" name="sport_golf"><span>Golf</span></label>
                <label class="chip"><input type="checkbox" name="sport_tenis"><span>Tenis</span></label>
                <label class="chip"><input type="checkbox" name="sport_pelota"><span>Juegos de pelota</span></label>
                <label class="chip"><input type="checkbox" name="sport_ciclismo"><span>Ciclismo</span></label>
              </div>
            </td>
          </tr>

          <tr>
            <td>Computadoras y dispositivos digitales</td>
            <td class="center"><input type="radio" name="comp" value="0"></td>
            <td class="center"><input type="radio" name="comp" value="1"></td>
            <td class="center"><input type="radio" name="comp" value="2"></td>
            <td class="center"><input type="radio" name="comp" value="3"></td>
            <td class="center"><input type="radio" name="comp" value="4"></td>
            <td class="center"><input type="radio" name="comp" value="5"></td>
            <td>
              <div class="chips flow">
                <label class="chip"><input type="checkbox" name="comp_pc"><span>Computador</span></label>
                <label class="chip"><input type="checkbox" name="comp_portatil"><span>Computadora portátil</span></label>
                <label class="chip"><input type="checkbox" name="comp_varios"><span>Varios dispositivos</span></label>
                <label class="chip"><input type="checkbox" name="comp_tableta"><span>Tableta</span></label>
                <label class="chip"><input type="checkbox" name="comp_phone"><span>Teléfonos inteligentes</span></label>
              </div>
            </td>
          </tr>

          <tr>
            <td>Lectura</td>
            <td class="center"><input type="radio" name="lect" value="0"></td>
            <td class="center"><input type="radio" name="lect" value="1"></td>
            <td class="center"><input type="radio" name="lect" value="2"></td>
            <td class="center"><input type="radio" name="lect" value="3"></td>
            <td class="center"><input type="radio" name="lect" value="4"></td>
            <td class="center"><input type="radio" name="lect" value="5"></td>
            <td>
              <div class="chips flow">
                <label class="chip"><input type="checkbox" name="lect_libro"><span>Libro</span></label>
                <label class="chip"><input type="checkbox" name="lect_digital"><span>Dispositivos digitales</span></label>
                <label class="chip"><input type="checkbox" name="lect_periodico"><span>Periódico</span></label>
                <label class="chip"><input type="checkbox" name="lect_revista"><span>Revista</span></label>
                <label class="chip"><input type="checkbox" name="lect_varios"><span>Varios medios</span></label>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <!-- Medidas del marco -->
    <div class="section">
      <h3>MEDIDAS DEL MARCO</h3>
      <div class="two soft">
        <div>
          <div style="font-weight:700;color:#7a2b6c;margin-bottom:6px">Ojo izquierdo / derecho</div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div><label>DNP (OI)</label><input class="input" name="dnp_oi"></div>
            <div><label>DNP (OD)</label><input class="input" name="dnp_od"></div>
          </div>
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:6px">
            <div><label>Altura pupilar (OI)</label><input class="input" name="altura_pupilar_oi"></div>
            <div><label>Altura pupilar (OD)</label><input class="input" name="altura_pupilar_od"></div>
          </div>
          <div style="margin-top:6px">
            <label>Altura total del cristalino</label><input class="input" name="altura_total_cristalino">
          </div>
          <div style="margin-top:6px">
            <label>Distancia al vértice</label><input class="input" name="distancia_al_vertice">
          </div>
        </div>
        <div>
          <div><label>Inclinación pantoscópica</label><input class="input" name="inclinacion_pantoscopica"></div>
          <div style="margin-top:6px"><label>Curva del borde</label><input class="input" name="curva_del_borde"></div>
        </div>
      </div>
    </div>

    <!-- Gafas anteriores + Receta previa -->
    <div class="section">
      <h3>GAFAS ANTERIORES</h3>
      <div class="two soft">
        <div>
          <label>Tipo de lente</label><input class="input" name="tipo_lente">
          <label style="margin-top:6px">Proveedor</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="proveedor" value="HOYA"><span>HOYA</span></label>
            <label class="chip"><input type="radio" name="proveedor" value="Otro"><span>Otro</span></label>
          </div>
          <label style="margin-top:6px">Diseño</label><input class="input" name="diseno">
          <label style="margin-top:6px">Longitud del pasillo</label><input class="input" name="longitud_pasillo">
        </div>
        <div>
          <h4 style="margin:0 0 6px;color:#7a2b6c">RECETA PREVIA</h4>
          <div style="font-weight:700;margin:2px 0 6px">Ojo izquierdo</div>
          <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px">
            <div><label>Esférico</label><input class="input" name="rp_esf_oi"></div>
            <div><label>Cilíndrico</label><input class="input" name="rp_cil_oi"></div>
            <div><label>Eje</label><input class="input" name="rp_eje_oi"></div>
            <div><label>Adición</label><input class="input" name="rp_adic_oi"></div>
          </div>

          <div style="font-weight:700;margin:10px 0 6px">Ojo derecho</div>
          <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:8px">
            <div><label>Esférico</label><input class="input" name="rp_esf_od"></div>
            <div><label>Cilíndrico</label><input class="input" name="rp_cil_od"></div>
            <div><label>Eje</label><input class="input" name="rp_eje_od"></div>
            <div><label>Adición</label><input class="input" name="rp_adic_od"></div>
          </div>

          <!-- CAMBIO: Prisma en RECETA PREVIA (Ojo derecho) -->
          <label style="margin-top:8px">Prisma</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="rp_prisma_od" value="Si"><span>Sí</span></label>
            <label class="chip"><input type="radio" name="rp_prisma_od" value="No"><span>No</span></label>
          </div>
          <!-- FIN CAMBIO -->

        </div>
      </div>
    </div>

    <!-- Satisfacción -->
    <div class="section">
      <h3>NIVEL DE SATISFACCIÓN</h3>
      <div class="chips">
        <label class="chip"><input type="radio" name="satisfaccion" value="Muy satisfecho"><span>Muy satisfecho</span></label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Satisfecho"><span>Satisfecho</span></label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Neutral"><span>Neutral</span></label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Insatisfecho"><span>Insatisfecho</span></label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Muy insatisfecho"><span>Muy insatisfecho</span></label>
      </div>
    </div>

    <div class="foot-logos">
      <img src="Imagen_Hoya.jpg" alt="HOYA">
      <img src="Imagen_tecnologia.jpg" alt="Tecnología japonesa">
    </div>

  </section>

  <!-- campo oculto para mandar Nº de orden -->
  <input type="hidden" name="order_id" id="orderIdField" />
</form>

<script>
/* ======= CONFIG ======= */
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbz8wYVJCHIBZPW2mzkpBkSUdGUzddeNmXcgpZmeTOfHHgiL1WcA1CMHIM8G4CaG5iMGEQ/exec";

/* ======= Utilidades ======= */
function pad(n){return String(n).padStart(2,'0')}
function generateOrderId(){
  const d = new Date();
  const yyyy = d.getFullYear();
  const mm = pad(d.getMonth()+1);
  const dd = pad(d.getDate());
  const hh = pad(d.getHours());
  const mi = pad(d.getMinutes());
  const ss = pad(d.getSeconds());
  const rand = Math.floor(1000 + Math.random()*9000);
  return `TRX-${yyyy}${mm}${dd}-${hh}${mi}${ss}-${rand}`;
}
function setOrderPill(id, ok=false){
  const pill = document.getElementById('orderPill');
  pill.textContent = id;
  pill.classList.toggle('ok', ok);
  const st = document.getElementById('orderStatus');
  st.classList.toggle('ok', ok);
  st.innerHTML = ok ? '<span class="check"></span> Orden generada, alguien de Trimax se contactará con usted'
                    : '<span class="check"></span> Orden pendiente';
}

/* ======= Nueva orden (resetea) ======= */
function newOrder(e){
  if(e) e.preventDefault();
  const form = document.getElementById('hoyaForm');
  form.reset();
  const id = generateOrderId();
  document.getElementById('orderIdField').value = id;
  setOrderPill(id, false);
  window.scrollTo({top:0, behavior:'smooth'});
}

/* ======= Enviar a Sheets + Imprimir ======= */
async function sendAndPrint(e){
  e.preventDefault();
  const btn = document.getElementById('sendBtn');
  btn.disabled = true;

  try{
    const form = document.getElementById('hoyaForm');
    const fd = new FormData(form);
    if(!fd.get('order_id')){ // por si acaso
      const id = generateOrderId();
      fd.set('order_id', id);
      document.getElementById('orderIdField').value = id;
    }

    fd.append('timestamp', new Date().toLocaleString());

    await fetch(WEB_APP_URL, { method:'POST', body:fd, mode:'no-cors' });

    // Marca orden como generada (verde + check)
    setOrderPill(fd.get('order_id'), true);

    // Imprimir / guardar PDF
    setTimeout(() => window.print(), 300);

  }catch(err){
    alert('Error al enviar/imprimir: ' + err.message);
  }finally{
    btn.disabled = false;
  }
}

/* ======= Init ======= */
newOrder(); // crea primer número de orden
</script>
</body>
</html>


