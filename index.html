<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Formulario iD Myself – HOYALUX</title>

<style>
/* ===== A4 y reset impresión ===== */
@page { size: A4; margin: 12mm }
html,body{height:100%}
body{
  margin:0;
  background:#eef2ff;
  font-family: ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
}

/* ===== Paleta ===== */
:root{
  --hoya-navy:#0b3d91;
  --hoya-navy-ink:#0a2d6f;
  --ink:#0f172a;
  --muted:#475569;
  --rose:#f7ecf5;
  --rose-border:#ead7e7;
  --accent:#7a2b6c;
}

/* ===== Botón superior ===== */
.toolbar{
  position: sticky; top:0; z-index:20;
  display:flex; justify-content:center;
  background:var(--hoya-navy);
  padding:10px;
  box-shadow:0 6px 16px rgba(2,6,23,.18);
}
.btn{
  background:#fff; color:var(--hoya-navy);
  border:0; padding:10px 16px; border-radius:10px;
  font-weight:800; cursor:pointer;
}
.btn:disabled{opacity:.6;cursor:not-allowed}

/* ===== Hoja ===== */
.sheet{ width:210mm; margin:0 auto; }
.page{
  background:#fff;
  box-shadow:0 10px 28px rgba(15,23,42,.15);
  margin:10mm 0;
  padding:0;
}

/* ===== Hero ===== */
.hero{
  position:relative;
  width: 210mm;                    /* ancho del hero */
  height: 73mm;                    /* alto del hero */
  margin: 0 auto;                  /* centra la imagen en la hoja */
  background:#ddd url('idmyself_header.jpg') center/cover no-repeat;
}
.hero .band{
  position:absolute; left:0; right:0; bottom:8mm;
  display:flex; justify-content:center;
}
.hero .title{
  background:var(--hoya-navy);
  color:#fff; font-weight:900; letter-spacing:.04em;
  padding:10px 20px; border-radius:8px;
  box-shadow:0 10px 22px rgba(2,6,23,.25);
}

/* ===== Secciones ===== */
.section{ padding:10mm 12mm 6mm }
.section h3{
  margin:0 0 6mm; color:#6d1c5e; letter-spacing:.2px;
  font-size:13.5px; display:flex; align-items:center; gap:8px;
}
.section h3::before{
  content:""; width:12px; height:12px; border-radius:3px; background:var(--hoya-navy);
}

/* ===== Panel azul (información personal) ===== */
.personal{
  background:var(--hoya-navy); color:#e6eefc;
  border-radius:10px; padding:10mm 12mm;
  --g:22px; background-image:
    linear-gradient(rgba(255,255,255,.08) 1px, transparent 1px),
    linear-gradient(90deg, rgba(255,255,255,.08) 1px, transparent 1px);
  background-size:var(--g) var(--g), var(--g) var(--g);
}
.personal h3{color:#fff}
.personal h3::before{background:#fff}
.personal label{color:#e6eefc}
.grid{display:grid; gap:10px 14px}
.col-12{grid-template-columns:repeat(12,1fr)}
.col-6{grid-column:span 6}
.col-4{grid-column:span 4}
.col-8{grid-column:span 8}
.col-3{grid-column:span 3}

.input, .line{
  width:100%; height:26px;
  border:none; border-bottom:1.5px solid rgba(255,255,255,.75);
  background:transparent; color:#fff; font:inherit;
}
.input::placeholder, .line::placeholder{ color:#dce7ff }
.radio-row{ display:flex; gap:14px; align-items:center }

/* ===== Caja rosada ===== */
.soft .input, .soft .line{
  background:var(--rose); color:var(--ink);
  border:1px solid var(--rose-border);
  border-radius:6px; height:28px; padding:0 8px;
}
label{font-size:12px; color:var(--muted); display:block}

/* ===== Dos columnas grandes ===== */
.two{display:grid; grid-template-columns: 1fr 1fr; gap:12mm}

/* ===== Chips (radios) ===== */
.chips{display:flex; flex-wrap:wrap; gap:6px}
.chips label{
  border:1px solid #e2e8f0; border-radius:999px;
  padding:4px 10px; font-size:11.5px; color:#111; cursor:pointer
}
.chips input{appearance:none; width:0; height:0; margin:0}
.chips label:has(input:checked){
  background:var(--rose); border-color:#e7cfe0; color:var(--accent);
}
/* separador “ó” entre los dos chips de cada grupo */
.chips .chip + .chip::before{
  content:"ó";
  margin:0 6px;
  color:#64748b;
  font-weight:600;
}

/* ===== Banner azul intermedio con fotos ===== */
.banner{ height:32mm; background:var(--hoya-navy) }
.banner img{ width:100%; height:100%; object-fit:cover; opacity:.9 }

/* ===== Tabla 0–5 ===== */
.table{ border-collapse:collapse; width:100%; font-size:11.5px }
.table th,.table td{ border:1px solid #eef2ff; padding:6px 8px; vertical-align:top }
.table th{ background:#f8fafc; color:#334155; font-weight:800 }

/* ===== Logos al pie de cada página ===== */
.foot-logos{
  display:flex; justify-content:space-between; align-items:center;
  padding:8mm 12mm 10mm;
}
.foot-logos img{ height:16mm }

/* Romper a la página siguiente */
.page-break{ page-break-before:always }

/* Ocultar elementos pantalla al imprimir (opcional) */
@media print{
  .toolbar{display:none}
  .page{box-shadow:none; margin:0}
}
</style>
</head>
<body>

<div class="toolbar">
  <button id="sendPrintBtn" class="btn" onclick="sendAndPrint()">Enviar a Google Sheets & Imprimir PDF</button>
</div>

<form id="hoyaForm" class="sheet">

  <!-- ============ PÁGINA 1 ============ -->
  <section class="page">

    <!-- Hero -->
    <div class="hero">
      <div class="band"><div class="title">FORMULARIO IDENTIFIER · iD MYSELF · HOYALUX</div></div>
    </div>

    <!-- Información personal (panel azul) -->
    <div class="section personal">
      <h3>INFORMACIÓN PERSONAL</h3>
      <div class="grid" style="grid-template-columns: repeat(12, 1fr);">
        <!-- Nombre del cliente (mantiene name="sistema" para tu hoja) -->
        <div class="col-6">
          <label>Nombre del cliente</label>
          <input class="line" name="sistema" placeholder="Nombre del cliente" />
        </div>
        <div class="col-6"></div>

        <div class="col-6">
          <label>Nombre</label>
          <input class="line" name="nombre" />
        </div>
        <div class="col-6">
          <label>Apellidos</label>
          <input class="line" name="apellidos" />
        </div>

        <div class="col-4">
          <label>Sexo</label>
          <div class="radio-row">
            <label><input type="radio" name="sexo" value="Masculino"> Masculino</label>
            <label><input type="radio" name="sexo" value="Femenino"> Femenino</label>
          </div>
        </div>
        <div class="col-8">
          <label>Fecha de nacimiento</label>
          <input class="line" name="fecha_nac" type="date" />
        </div>
      </div>
    </div>

    <!-- Prescripción -->
    <div class="section">
      <h3>PRESCRIPCIÓN</h3>
      <div class="two soft">
        <!-- Ojo izquierdo -->
        <div>
          <div style="font-weight:700;color:#7a2b6c;margin-bottom:6px">Ojo izquierdo</div>
          <label>Esférico</label><input class="input" name="esf_oi">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div><label>Cilíndrico</label><input class="input" name="cil_oi"></div>
            <div><label>Eje</label><input class="input" name="eje_oi"></div>
          </div>
          <label>Adición</label><input class="input" name="adic_oi">
          <label>Prisma</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="prisma_oi" value="Si"> Sí</label>
            <label class="chip"><input type="radio" name="prisma_oi" value="No"> No</label>
          </div>
        </div>

        <!-- Ojo derecho -->
        <div>
          <div style="font-weight:700;color:#7a2b6c;margin-bottom:6px">Ojo derecho</div>
          <label>Esférico</label><input class="input" name="esf_od">
          <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px">
            <div><label>Cilíndrico</label><input class="input" name="cil_od"></div>
            <div><label>Eje</label><input class="input" name="eje_od"></div>
          </div>
          <label>Adición</label><input class="input" name="adic_od">
          <label>Primer par de lentes</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="primer_par" value="Si"> Sí</label>
            <label class="chip"><input type="radio" name="primer_par" value="No"> No</label>
          </div>
        </div>
      </div>
    </div>

    <!-- Información del prisma -->
    <div class="section">
      <h3>INFORMACIÓN DEL PRISMA</h3>
      <div class="two soft">
        <!-- OI -->
        <div>
          <div style="font-weight:700;color:#7a2b6c;margin-bottom:6px">Ojo izquierdo</div>

          <!-- Horizontal OI: valor + chips en una sola columna (Nasal / Temporal) -->
          <div style="display:grid;grid-template-columns:1fr auto;gap:8px;align-items:end">
            <div>
              <label>Horizontal (valor)</label>
              <input class="input" name="prisma_h_oi_val">
            </div>
            <div class="chips">
              <label class="chip"><input type="radio" name="horiz_oi" value="Nasal"> Nasal</label>
              <label class="chip"><input type="radio" name="horiz_oi" value="Temporal"> Temporal</label>
            </div>
          </div>

          <!-- Vertical OI -->
          <div style="display:grid;grid-template-columns:1fr auto;gap:8px;align-items:end;margin-top:6px">
            <div>
              <label>Vertical (valor)</label>
              <input class="input" name="prisma_v_oi_val">
            </div>
            <div class="chips">
              <label class="chip"><input type="radio" name="vert_oi" value="Nasal"> Nasal</label>
              <label class="chip"><input type="radio" name="vert_oi" value="Temporal"> Temporal</label>
            </div>
          </div>

          <label style="margin-top:6px">Resultado</label><input class="input" name="prisma_res_oi">
        </div>

        <!-- OD -->
        <div>
          <div style="font-weight:700;color:#7a2b6c;margin-bottom:6px">Ojo derecho</div>

          <!-- Horizontal OD -->
          <div style="display:grid;grid-template-columns:1fr auto;gap:8px;align-items:end">
            <div>
              <label>Horizontal (valor)</label>
              <input class="input" name="prisma_h_od_val">
            </div>
            <div class="chips">
              <label class="chip"><input type="radio" name="horiz_od" value="Nasal"> Nasal</label>
              <label class="chip"><input type="radio" name="horiz_od" value="Temporal"> Temporal</label>
            </div>
          </div>

          <!-- Vertical OD -->
          <div style="display:grid;grid-template-columns:1fr auto;gap:8px;align-items:end;margin-top:6px">
            <div>
              <label>Vertical (valor)</label>
              <input class="input" name="prisma_v_od_val">
            </div>
            <div class="chips">
              <label class="chip"><input type="radio" name="vert_od" value="Nasal"> Nasal</label>
              <label class="chip"><input type="radio" name="vert_od" value="Temporal"> Temporal</label>
            </div>
          </div>

          <label style="margin-top:6px">Resultado</label><input class="input" name="prisma_res_od">
        </div>
      </div>
    </div>

    <!-- Estilo de vida -->
    <div class="section">
      <h3>ESTILO DE VIDA · ¿Dónde pasas el día?</h3>
      <div style="display:grid;grid-template-columns:1fr;gap:10px" class="soft">
        <div>
          <label>Ambientes interiores</label>
          <div class="chips">
            <label><input type="radio" name="int" value="0%">0%</label>
            <label><input type="radio" name="int" value="10%">10%</label>
            <label><input type="radio" name="int" value="20%">20%</label>
            <label><input type="radio" name="int" value="30%">30%</label>
            <label><input type="radio" name="int" value="40%">40%</label>
            <label><input type="radio" name="int" value="50%">50%</label>
            <label><input type="radio" name="int" value="60%">60%</label>
            <label><input type="radio" name="int" value="70%">70%</label>
            <label><input type="radio" name="int" value="80%">80%</label>
            <label><input type="radio" name="int" value="90%">90%</label>
            <label><input type="radio" name="int" value="100%">100%</label>
          </div>
        </div>
        <div>
          <label>Ambientes exteriores</label>
          <div class="chips">
            <label><input type="radio" name="ext" value="0%">0%</label>
            <label><input type="radio" name="ext" value="10%">10%</label>
            <label><input type="radio" name="ext" value="20%">20%</label>
            <label><input type="radio" name="ext" value="30%">30%</label>
            <label><input type="radio" name="ext" value="40%">40%</label>
            <label><input type="radio" name="ext" value="50%">50%</label>
            <label><input type="radio" name="ext" value="60%">60%</label>
            <label><input type="radio" name="ext" value="70%">70%</label>
            <label><input type="radio" name="ext" value="80%">80%</label>
            <label><input type="radio" name="ext" value="90%">90%</label>
            <label><input type="radio" name="ext" value="100%">100%</label>
          </div>
        </div>
      </div>
    </div>

    <div class="banner"><img src="idmyself_actividades.jpg" alt=""></div>

    <div class="foot-logos">
      <img src="Imagen_Hoya.jpg" alt="HOYA">
      <img src="Imagen_tecnologia.jpg" alt="Tecnología japonesa">
    </div>

  </section>

</form>

<script>
/* Cambia por tu URL (Web App desplegado con acceso “Cualquiera”)
   Si vuelves a desplegar y cambia la URL, solo reemplázala aquí. */
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbz8wYVJCHIBZPW2mzkpBkSUdGUzddeNmXcgpZmeTOfHHgiL1WcA1CMHIM8G4CaG5iMGEQ/exec";

async function sendAndPrint(){
  const btn = document.getElementById('sendPrintBtn');
  btn.disabled = true;

  try{
    const form = document.getElementById('hoyaForm');
    const fd = new FormData(form);
    fd.append('timestamp', new Date().toLocaleString());

    // Para evitar bloqueos CORS en Apps Script, usamos no-cors
    await fetch(WEB_APP_URL, { method:'POST', body:fd, mode:'no-cors' });

    // Da un pequeño respiro al envío y abre el diálogo de impresión
    setTimeout(() => window.print(), 300);
  }catch(e){
    alert('Error al enviar/imprimir: ' + e.message);
  }finally{
    btn.disabled = false;
  }
}
</script>
</body>
</html>
