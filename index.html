<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Formulario Identifier – iD Myself – HOYALUX</title>
<style>
  :root{
    --navy:#0a2d6f; --blue:#0b3d91; --ink:#0f172a; --muted:#475569;
    --chip:#e2e8f0; --chip-on:#f6e8f3; --chip-on-b:#e7cfe0;
  }
  body{margin:0;background:#eef2ff;font-family:ui-sans-serif,system-ui,Segoe UI,Roboto,Arial}
  .sheet{max-width:980px;margin:0 auto;background:#fff;box-shadow:0 8px 24px rgba(2,6,23,.15)}
  header{background:linear-gradient(180deg,#123e92,#0b3d91);color:#fff;padding:18px 22px}
  h1{font-size:20px;margin:0}
  section{padding:16px 22px}
  h2{color:#7a2b6c;font-size:15px;margin:0 0 12px;display:flex;align-items:center;gap:8px}
  h2::before{content:"";width:12px;height:12px;background:#0b3d91;border-radius:3px}
  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:10px 14px}
  .col-12{grid-column:span 12}.col-6{grid-column:span 6}.col-4{grid-column:span 4}.col-3{grid-column:span 3}.col-2{grid-column:span 2}
  label.small{font-size:12px;color:#475569;display:block;margin-bottom:3px}
  input[type="text"],input[type="number"],input[type="date"],input[type="tel"]{
    width:100%;padding:8px 10px;border:1px solid #e5e7eb;border-radius:6px;background:#fff
  }
  .row{display:flex;gap:8px;flex-wrap:wrap}
  .chips{display:flex;gap:8px;flex-wrap:wrap}
  .chip{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--chip);border-radius:999px;padding:6px 10px;font-size:13px;cursor:pointer}
  .chip input{appearance:none;width:14px;height:14px;border:1px solid #cbd5e1;border-radius:50%}
  .chip input[type="checkbox"]{border-radius:3px}
  .chip input:checked{background:#7a2b6c;border-color:#7a2b6c}
  .chip.on{background:var(--chip-on);border-color:var(--chip-on-b)}
  .sep{height:1px;background:#f1f5f9;margin:10px 0}
  .btnbar{display:flex;justify-content:flex-end;padding:18px 22px}
  button{background:#0a2d6f;color:#fff;border:0;border-radius:8px;padding:10px 16px;font-weight:600;cursor:pointer}
  .help{color:#64748b;font-size:12px}
</style>
</head>
<body>
<div class="sheet">
  <header><h1>FORMULARIO IDENTIFIER · iD MYSELF · HOYALUX</h1></header>

  <!-- ======= FORMULARIO ======= -->
  <form id="formHoya">
    <!-- Información personal -->
    <section>
      <h2>INFORMACIÓN PERSONAL</h2>
      <div class="grid">
        <div class="col-6">
          <label class="small">Sistema operativo del cliente</label>
          <input type="text" name="sistema" placeholder="Android / iOS / Otro">
        </div>
        <div class="col-3">
          <label class="small">Nombre</label>
          <input type="text" name="nombre">
        </div>
        <div class="col-3">
          <label class="small">Apellidos</label>
          <input type="text" name="apellidos">
        </div>
        <div class="col-4">
          <label class="small">Sexo</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="sexo" value="Masculino">Masculino</label>
            <label class="chip"><input type="radio" name="sexo" value="Femenino">Femenino</label>
          </div>
        </div>
        <div class="col-4">
          <label class="small">Fecha de nacimiento</label>
          <input type="date" name="fecha_nac">
        </div>
      </div>
    </section>

    <!-- Prescripción -->
    <section>
      <h2>PRESCRIPCIÓN</h2>
      <div class="grid">
        <div class="col-6">
          <div class="grid">
            <div class="col-3"><label class="small">Esférico OI</label><input type="text" name="esf_oi"></div>
            <div class="col-3"><label class="small">Cilíndrico OI</label><input type="text" name="cil_oi"></div>
            <div class="col-3"><label class="small">Eje OI</label><input type="text" name="eje_oi"></div>
            <div class="col-3"><label class="small">Adición OI</label><input type="text" name="adic_oi"></div>
          </div>
        </div>
        <div class="col-6">
          <div class="grid">
            <div class="col-3"><label class="small">Esférico OD</label><input type="text" name="esf_od"></div>
            <div class="col-3"><label class="small">Cilíndrico OD</label><input type="text" name="cil_od"></div>
            <div class="col-3"><label class="small">Eje OD</label><input type="text" name="eje_od"></div>
            <div class="col-3"><label class="small">Adición OD</label><input type="text" name="adic_od"></div>
          </div>
        </div>

        <div class="col-4">
          <label class="small">¿Prisma OI?</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="prisma_oi" value="Sí">Sí</label>
            <label class="chip"><input type="radio" name="prisma_oi" value="No">No</label>
          </div>
        </div>

        <div class="col-4">
          <label class="small">¿Primer par de lentes?</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="primer_par" value="Sí">Sí</label>
            <label class="chip"><input type="radio" name="primer_par" value="No">No</label>
          </div>
        </div>
      </div>
    </section>

    <!-- Información del prisma -->
    <section>
      <h2>INFORMACIÓN DEL PRISMA</h2>
      <div class="grid">
        <div class="col-6">
          <div class="grid">
            <div class="col-4"><label class="small">Horizontal OI (mm)</label><input type="text" name="prisma_h_oi_val"></div>
            <div class="col-8">
              <label class="small">Orientación horizontal OI</label>
              <div class="chips">
                <label class="chip"><input type="radio" name="horiz_oi" value="Nasal">Nasal</label>
                <label class="chip"><input type="radio" name="horiz_oi" value="Temporal">Temporal</label>
              </div>
            </div>

            <div class="col-4"><label class="small">Vertical OI (mm)</label><input type="text" name="prisma_v_oi_val"></div>
            <div class="col-8">
              <label class="small">Orientación vertical OI</label>
              <div class="chips">
                <label class="chip"><input type="radio" name="vert_oi" value="Nasal">Nasal</label>
                <label class="chip"><input type="radio" name="vert_oi" value="Temporal">Temporal</label>
              </div>
            </div>

            <div class="col-12"><label class="small">Resultado OI</label><input type="text" name="prisma_res_oi"></div>
          </div>
        </div>

        <div class="col-6">
          <div class="grid">
            <div class="col-4"><label class="small">Horizontal OD (mm)</label><input type="text" name="prisma_h_od_val"></div>
            <div class="col-8">
              <label class="small">Orientación horizontal OD</label>
              <div class="chips">
                <label class="chip"><input type="radio" name="horiz_od" value="Nasal">Nasal</label>
                <label class="chip"><input type="radio" name="horiz_od" value="Temporal">Temporal</label>
              </div>
            </div>

            <div class="col-4"><label class="small">Vertical OD (mm)</label><input type="text" name="prisma_v_od_val"></div>
            <div class="col-8">
              <label class="small">Orientación vertical OD</label>
              <div class="chips">
                <label class="chip"><input type="radio" name="vert_od" value="Nasal">Nasal</label>
                <label class="chip"><input type="radio" name="vert_od" value="Temporal">Temporal</label>
              </div>
            </div>

            <div class="col-12"><label class="small">Resultado OD</label><input type="text" name="prisma_res_od"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Estilo de vida -->
    <section>
      <h2>ESTILO DE VIDA · ¿Dónde pasas el día?</h2>
      <div class="grid">
        <div class="col-12">
          <label class="small">Ambientes interiores</label>
          <div class="chips" id="grp-int"></div>
        </div>
        <div class="col-12">
          <label class="small">Ambientes exteriores</label>
          <div class="chips" id="grp-ext"></div>
        </div>
      </div>
    </section>

    <!-- Clasificación de importancia 0..5 -->
    <section>
      <h2>CLASIFICACIÓN DE IMPORTANCIA (0 = poco, 5 = muy importante)</h2>
      <div class="grid">
        <div class="col-12" id="ratings"></div>
      </div>
      <div class="sep"></div>
      <!-- Detalles por categoría -->
      <div class="grid">
        <div class="col-12">
          <label class="small">Conducir – detalles</label>
          <div class="chips" id="chips-drive"></div>
        </div>
        <div class="col-12">
          <label class="small">Vida profesional – detalles</label>
          <div class="chips" id="chips-vida"></div>
        </div>
        <div class="col-12">
          <label class="small">Deportes – detalles</label>
          <div class="chips" id="chips-sport"></div>
        </div>
        <div class="col-12">
          <label class="small">Computadoras y dispositivos – detalles</label>
          <div class="chips" id="chips-comp"></div>
        </div>
        <div class="col-12">
          <label class="small">Lectura – detalles</label>
          <div class="chips" id="chips-lect"></div>
        </div>
      </div>
    </section>

    <!-- Medidas del marco -->
    <section>
      <h2>MEDIDAS DEL MARCO</h2>
      <div class="grid">
        <div class="col-2"><label class="small">DNP OI</label><input type="text" name="dnp_oi"></div>
        <div class="col-2"><label class="small">DNP OD</label><input type="text" name="dnp_od"></div>
        <div class="col-2"><label class="small">Altura pupilar OI</label><input type="text" name="altura_pupilar_oi"></div>
        <div class="col-2"><label class="small">Altura pupilar OD</label><input type="text" name="altura_pupilar_od"></div>
        <div class="col-2"><label class="small">Altura total del cristalino</label><input type="text" name="altura_total_cristalino"></div>
        <div class="col-2"><label class="small">Distancia al vértice</label><input type="text" name="distancia_al_vertice"></div>
        <div class="col-3"><label class="small">Inclinación pantoscópica</label><input type="text" name="inclinacion_pantoscopica"></div>
        <div class="col-3"><label class="small">Curva del borde</label><input type="text" name="curva_del_borde"></div>
      </div>
    </section>

    <!-- Gafas anteriores y Receta previa -->
    <section>
      <h2>GAFAS ANTERIORES</h2>
      <div class="grid">
        <div class="col-3"><label class="small">Tipo de lente</label><input type="text" name="tipo_lente"></div>
        <div class="col-3">
          <label class="small">Proveedor</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="proveedor" value="HOYA">HOYA</label>
            <label class="chip"><input type="radio" name="proveedor" value="Otro">Otro</label>
          </div>
        </div>
        <div class="col-3"><label class="small">Diseño</label><input type="text" name="diseno"></div>
        <div class="col-3"><label class="small">Longitud del pasillo</label><input type="text" name="longitud_pasillo"></div>
      </div>

      <div class="sep"></div>
      <h2>RECETA PREVIA</h2>
      <div class="grid">
        <div class="col-6">
          <div class="grid">
            <div class="col-3"><label class="small">Cil OI</label><input type="text" name="rp_cil_oi"></div>
            <div class="col-3"><label class="small">Esf OI</label><input type="text" name="rp_esf_oi"></div>
            <div class="col-3"><label class="small">Eje OI</label><input type="text" name="rp_eje_oi"></div>
            <div class="col-3"><label class="small">Adic OI</label><input type="text" name="rp_adic_oi"></div>
          </div>
        </div>
        <div class="col-6">
          <div class="grid">
            <div class="col-3"><label class="small">Cil OD</label><input type="text" name="rp_cil_od"></div>
            <div class="col-3"><label class="small">Esf OD</label><input type="text" name="rp_esf_od"></div>
            <div class="col-3"><label class="small">Eje OD</label><input type="text" name="rp_eje_od"></div>
            <div class="col-3"><label class="small">Adic OD</label><input type="text" name="rp_adic_od"></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Satisfacción -->
    <section>
      <h2>NIVEL DE SATISFACCIÓN</h2>
      <div class="chips">
        <label class="chip"><input type="radio" name="satisfaccion" value="Muy satisfecho">Muy satisfecho</label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Satisfecho">Satisfecho</label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Neutral">Neutral</label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Insatisfecho">Insatisfecho</label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Muy insatisfecho">Muy insatisfecho</label>
      </div>
    </section>

    <div class="btnbar">
      <button type="submit">Enviar</button>
    </div>
    <p class="help" style="padding:0 22px 22px">Al enviar, los datos se guardan en tu Google Sheet.</p>
  </form>
</div>

<script>
/* ====== CONFIGURAR TU URL DE APPS SCRIPT ====== */
const APPS_SCRIPT_URL =
  "https://script.google.com/macros/s/AKfycby1V6T1CuWqWJ-ooLsbm6zVx2sPoMr-oAcAx8DGx6VmrIR0Cj7i4UVq5YUxmZp85VXiTw/exec";

/* === Generadores para evitar HTML gigante === */
function buildPercentChips(containerId, name){
  const cont = document.getElementById(containerId);
  const steps = [0,10,20,30,40,50,60,70,80,90,100];
  steps.forEach(v=>{
    const lbl = document.createElement('label'); lbl.className='chip';
    lbl.innerHTML = `<input type="radio" name="${name}" value="${v}%"> ${v}%`;
    cont.appendChild(lbl);
  });
}
function buildRatings(names){
  const box = document.getElementById('ratings');
  names.forEach(n=>{
    const row = document.createElement('div');
    row.className='row'; row.style.margin='8px 0';
    const title = document.createElement('div');
    title.textContent = n.toUpperCase()+':'; title.style.minWidth='120px'; title.style.fontWeight='600';
    row.appendChild(title);
    for(let i=0;i<=5;i++){
      const lbl = document.createElement('label'); lbl.className='chip';
      lbl.innerHTML = `<input type="radio" name="${n}" value="${i}"> ${i}`;
      row.appendChild(lbl);
    }
    box.appendChild(row);
  });
}
function buildCheckboxChips(containerId, defs){
  const cont = document.getElementById(containerId);
  defs.forEach(d=>{
    const lbl = document.createElement('label'); lbl.className='chip';
    lbl.innerHTML = `<input type="checkbox" name="${d.name}" value="1"> ${d.text}`;
    cont.appendChild(lbl);
  });
}

/* Render dinámico */
buildPercentChips('grp-int','int');
buildPercentChips('grp-ext','ext');
buildRatings(['tv','compras','drive','vida','sport','comp','lect']);
buildCheckboxChips('chips-drive',[
  {name:'drive_auto',text:'Auto'},{name:'drive_bus',text:'Autobús'},
  {name:'drive_moto',text:'Moto'},{name:'drive_tren',text:'Tren'},
  {name:'drive_camion',text:'Camión'}
]);
buildCheckboxChips('chips-vida',[
  {name:'work_cerca',text:'Cerca'},
  {name:'work_inter_cercano',text:'Intermedio y cercano'},
  {name:'work_inter_laboral',text:'Intermedio laboral'},
  {name:'work_lejos',text:'Lejos'},
  {name:'work_inter_lejano',text:'Intermedio y lejano'}
]);
buildCheckboxChips('chips-sport',[
  {name:'sport_gimnasia',text:'Gimnasia'},{name:'sport_correr',text:'Correr y caminar'},
  {name:'sport_golf',text:'Golf'},{name:'sport_tenis',text:'Tenis'},
  {name:'sport_pelota',text:'Juegos de pelota'},{name:'sport_ciclismo',text:'Ciclismo'}
]);
buildCheckboxChips('chips-comp',[
  {name:'comp_pc',text:'Computador'},{name:'comp_portatil',text:'Portátil'},
  {name:'comp_varios',text:'Varios dispositivos'},{name:'comp_tableta',text:'Tableta'},
  {name:'comp_phone',text:'Teléfonos inteligentes'}
]);
buildCheckboxChips('chips-lect',[
  {name:'lect_libro',text:'Libro'},{name:'lect_digital',text:'Dispositivos digitales'},
  {name:'lect_periodico',text:'Periódico'},{name:'lect_revista',text:'Revista'},
  {name:'lect_varios',text:'Varios medios'}
]);

/* ====== Envío al Sheet ====== */
function collectData(){
  const data = {};
  document.querySelectorAll('input[name], select[name], textarea[name]').forEach(el=>{
    const n = el.name;
    if(!n) return;
    if(el.type==='radio'){ if(el.checked) data[n]=el.value; }
    else if(el.type==='checkbox'){ data[n]= el.checked ? '1' : ''; }
    else{ data[n]= el.value ?? ''; }
  });
  return data;
}
async function sendForm(e){
  e.preventDefault();
  const payload = collectData();
  try{
    await fetch(APPS_SCRIPT_URL,{
      method:'POST',mode:'no-cors',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify(payload)
    });
    alert('¡Enviado! Revisa tu Google Sheet.');
    // document.getElementById('formHoya').reset(); // si deseas limpiar
  }catch(err){
    console.error(err);
    alert('Hubo un error enviando el formulario.');
  }
}
document.getElementById('formHoya').addEventListener('submit', sendForm);
</script>
</body>
</html>
