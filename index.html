<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Formulario Identifier – iD Myself – HOYALUX</title>
<style>
  :root{
    --navy:#0a2d6f;
    --blue:#0b3d91;
    --grid:#e6e9ff;
    --accent:#7a2b6c;
    --accent-bg:#f6e8f3;
    --ink:#0f172a;
    --muted:#475569;
  }
  html,body{height:100%}
  body{margin:0;background:#eef2ff;font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Helvetica,Arial;color:var(--ink)}
  .sheet{width:1100px;max-width:100%;margin:0 auto;background:#fff;box-shadow:0 8px 24px rgba(2,6,23,.15)}
  .hero{position:relative;height:260px;overflow:hidden}
  .hero img{width:100%;height:100%;object-fit:cover;object-position:35% 35%}
  .band{position:absolute;left:0;right:0;bottom:14px;display:flex;justify-content:center}
  .title{background:var(--navy);color:#fff;padding:10px 22px;border-radius:8px;letter-spacing:.06em;font-weight:800;font-size:20px;box-shadow:0 8px 18px rgba(2,6,23,.25)}
  .section{padding:18px 22px}
  .section-title{color:var(--accent);font-weight:800;font-size:14px;letter-spacing:.4px;display:flex;align-items:center;gap:10px;margin:0 0 10px}
  .section-title::before{content:"";width:12px;height:12px;background:var(--blue);border-radius:3px}
  .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:10px 14px;align-items:end}
  .col-12{grid-column:span 12}
  .col-8{ grid-column:span 8 }
  .col-6{ grid-column:span 6 }
  .col-4{ grid-column:span 4 }
  .col-3{ grid-column:span 3 }
  .col-2{ grid-column:span 2 }
  label{font-size:12px;color:var(--muted);display:block;margin-bottom:4px}
  input[type="text"], input[type="date"], input[type="number"]{
    width:100%;border:1px solid #e5e7eb;background:#fbfaff;border-radius:6px;padding:8px 10px;font:inherit;color:var(--ink)
  }
  .chips{display:flex;flex-wrap:wrap;gap:8px}
  .chip{display:inline-flex;align-items:center;gap:6px;border:1px solid #e5e7eb;border-radius:999px;padding:6px 10px;background:#fff;cursor:pointer}
  .chip input{accent-color:var(--accent)}
  .line{border-bottom:1px solid var(--grid)}
  .subcap{font-weight:700;color:#6b21a8;margin:6px 0}
  .pr-row{display:grid;grid-template-columns:90px 1fr auto;gap:8px;align-items:center}
  .pill{display:inline-block;padding:6px 10px;border:1px solid #e5e7eb;border-radius:999px;background:#fff}
  .actions{display:flex;gap:10px;align-items:center;justify-content:flex-end;padding:12px 22px;border-top:1px dashed #e5e7eb}
  .btn{background:var(--navy);color:#fff;border:0;border-radius:8px;padding:10px 14px;cursor:pointer}
  .btn.ghost{background:transparent;color:var(--navy);border:2px solid var(--navy)}
  .msg{font-size:13px;margin-left:auto}
  .banner{height:180px;background:var(--navy);overflow:hidden}
  .banner img{width:100%;height:100%;object-fit:cover;opacity:.92}
  .page-footer{display:flex;justify-content:space-between;align-items:center;padding:10px 22px 18px}
  .page-footer img{height:50px}
  @media print{
    .actions,.page-footer{display:none}
    .sheet{box-shadow:none}
  }
</style>
</head>
<body>
<div class="sheet">
  <!-- Encabezado -->
  <div class="hero">
    <img src="idmyself_header.jpg" alt="Header HOYA" />
    <div class="band"><div class="title">FORMULARIO IDENTIFIER · iD MYSELF · HOYALUX</div></div>
  </div>

  <form id="formHoya">
    <!-- Información personal -->
    <section class="section">
      <h3 class="section-title">INFORMACIÓN PERSONAL</h3>
      <div class="grid">
        <div class="col-6">
          <label for="sistema">Sistema operativo del cliente</label>
          <input id="sistema" name="sistema" placeholder="Android / iOS / Otro" />
        </div>
        <div class="col-6"></div>
        <div class="col-6"><label for="nombre">Nombre</label><input id="nombre" name="nombre" /></div>
        <div class="col-6"><label for="apellidos">Apellidos</label><input id="apellidos" name="apellidos" /></div>
        <div class="col-4">
          <label>Sexo</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="sexo" value="Masculino"> Masculino</label>
            <label class="chip"><input type="radio" name="sexo" value="Femenino"> Femenino</label>
          </div>
        </div>
        <div class="col-8"><label for="fecha_nac">Fecha de nacimiento</label><input type="date" id="fecha_nac" name="fecha_nac" /></div>
      </div>
    </section>

    <!-- Prescripción -->
    <section class="section" style="padding-top:0">
      <h3 class="section-title">PRESCRIPCIÓN</h3>
      <div class="grid">
        <div class="col-6"><div class="subcap">Ojo izquierdo</div></div>
        <div class="col-6"><div class="subcap">Ojo derecho</div></div>

        <div class="col-3"><label>Esférico</label><input name="esf_oi" /></div>
        <div class="col-3"><label>Cilíndrico</label><input name="cil_oi" /></div>
        <div class="col-3"><label>Eje</label><input name="eje_oi" /></div>
        <div class="col-3"><label>Esférico</label><input name="esf_od" /></div>
        <div class="col-3"><label>Cilíndrico</label><input name="cil_od" /></div>
        <div class="col-3"><label>Eje</label><input name="eje_od" /></div>

        <div class="col-3"><label>Adición</label><input name="adic_oi" /></div>
        <div class="col-3">
          <label>Prisma (OI)</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="prisma_oi" value="Sí"> Sí</label>
            <label class="chip"><input type="radio" name="prisma_oi" value="No"> No</label>
          </div>
        </div>
        <div class="col-3"><label>Adición</label><input name="adic_od" /></div>
        <div class="col-3">
          <label>Primer par de lentes</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="primer_par" value="Sí"> Sí</label>
            <label class="chip"><input type="radio" name="primer_par" value="No"> No</label>
          </div>
        </div>
      </div>
    </section>

    <!-- Información del prisma -->
    <section class="section" style="padding-top:0">
      <h3 class="section-title">INFORMACIÓN DEL PRISMA</h3>
      <div class="grid">
        <div class="col-6">
          <div class="subcap">Ojo izquierdo</div>
          <div class="pr-row">
            <label>Horizontal</label>
            <input name="prisma_h_oi_val" placeholder="mm" />
            <div class="chips">
              <label class="chip"><input type="radio" name="horiz_oi" value="Nasal"> Nasal</label>
              <label class="chip"><input type="radio" name="horiz_oi" value="Temporal"> Temporal</label>
            </div>
          </div>
          <div class="pr-row">
            <label>Vertical</label>
            <input name="prisma_v_oi_val" placeholder="mm" />
            <div class="chips">
              <label class="chip"><input type="radio" name="vert_oi" value="Nasal"> Nasal</label>
              <label class="chip"><input type="radio" name="vert_oi" value="Temporal"> Temporal</label>
            </div>
          </div>
          <div class="pr-row">
            <label>Resultado</label>
            <input name="prisma_res_oi" />
            <div></div>
          </div>
        </div>

        <div class="col-6">
          <div class="subcap">Ojo derecho</div>
          <div class="pr-row">
            <label>Horizontal</label>
            <input name="prisma_h_od_val" placeholder="mm" />
            <div class="chips">
              <label class="chip"><input type="radio" name="horiz_od" value="Nasal"> Nasal</label>
              <label class="chip"><input type="radio" name="horiz_od" value="Temporal"> Temporal</label>
            </div>
          </div>
          <div class="pr-row">
            <label>Vertical</label>
            <input name="prisma_v_od_val" placeholder="mm" />
            <div class="chips">
              <label class="chip"><input type="radio" name="vert_od" value="Nasal"> Nasal</label>
              <label class="chip"><input type="radio" name="vert_od" value="Temporal"> Temporal</label>
            </div>
          </div>
          <div class="pr-row">
            <label>Resultado</label>
            <input name="prisma_res_od" />
            <div></div>
          </div>
        </div>
      </div>
    </section>

    <!-- Estilo de vida -->
    <section class="section" style="padding-top:0">
      <h3 class="section-title">ESTILO DE VIDA · ¿Dónde pasas el día?</h3>
      <div class="grid">
        <div class="col-12"><label>Ambientes interiores</label></div>
        <div class="col-12 chips">
          <!-- int (0..100) -->
          <label class="chip"><input type="radio" name="int" value="0%">0%</label>
          <label class="chip"><input type="radio" name="int" value="10%">10%</label>
          <label class="chip"><input type="radio" name="int" value="20%">20%</label>
          <label class="chip"><input type="radio" name="int" value="30%">30%</label>
          <label class="chip"><input type="radio" name="int" value="40%">40%</label>
          <label class="chip"><input type="radio" name="int" value="50%">50%</label>
          <label class="chip"><input type="radio" name="int" value="60%">60%</label>
          <label class="chip"><input type="radio" name="int" value="70%">70%</label>
          <label class="chip"><input type="radio" name="int" value="80%">80%</label>
          <label class="chip"><input type="radio" name="int" value="90%">90%</label>
          <label class="chip"><input type="radio" name="int" value="100%">100%</label>
        </div>

        <div class="col-12"><label>Ambientes exteriores</label></div>
        <div class="col-12 chips">
          <!-- ext (0..100) -->
          <label class="chip"><input type="radio" name="ext" value="0%">0%</label>
          <label class="chip"><input type="radio" name="ext" value="10%">10%</label>
          <label class="chip"><input type="radio" name="ext" value="20%">20%</label>
          <label class="chip"><input type="radio" name="ext" value="30%">30%</label>
          <label class="chip"><input type="radio" name="ext" value="40%">40%</label>
          <label class="chip"><input type="radio" name="ext" value="50%">50%</label>
          <label class="chip"><input type="radio" name="ext" value="60%">60%</label>
          <label class="chip"><input type="radio" name="ext" value="70%">70%</label>
          <label class="chip"><input type="radio" name="ext" value="80%">80%</label>
          <label class="chip"><input type="radio" name="ext" value="90%">90%</label>
          <label class="chip"><input type="radio" name="ext" value="100%">100%</label>
        </div>

        <!-- Importancias 0..5 (tv, compras, drive, vida, sport, comp, lect) -->
        <div class="col-12"><label>Importancia (0..5)</label></div>
        <div class="col-12 chips">
          <span class="pill">TV:</span>
          <label class="chip"><input type="radio" name="tv" value="0">0</label>
          <label class="chip"><input type="radio" name="tv" value="1">1</label>
          <label class="chip"><input type="radio" name="tv" value="2">2</label>
          <label class="chip"><input type="radio" name="tv" value="3">3</label>
          <label class="chip"><input type="radio" name="tv" value="4">4</label>
          <label class="chip"><input type="radio" name="tv" value="5">5</label>

          <span class="pill">Compras:</span>
          <label class="chip"><input type="radio" name="compras" value="0">0</label>
          <label class="chip"><input type="radio" name="compras" value="1">1</label>
          <label class="chip"><input type="radio" name="compras" value="2">2</label>
          <label class="chip"><input type="radio" name="compras" value="3">3</label>
          <label class="chip"><input type="radio" name="compras" value="4">4</label>
          <label class="chip"><input type="radio" name="compras" value="5">5</label>

          <span class="pill">Conducir:</span>
          <label class="chip"><input type="radio" name="drive" value="0">0</label>
          <label class="chip"><input type="radio" name="drive" value="1">1</label>
          <label class="chip"><input type="radio" name="drive" value="2">2</label>
          <label class="chip"><input type="radio" name="drive" value="3">3</label>
          <label class="chip"><input type="radio" name="drive" value="4">4</label>
          <label class="chip"><input type="radio" name="drive" value="5">5</label>

          <span class="pill">Vida profesional:</span>
          <label class="chip"><input type="radio" name="vida" value="0">0</label>
          <label class="chip"><input type="radio" name="vida" value="1">1</label>
          <label class="chip"><input type="radio" name="vida" value="2">2</label>
          <label class="chip"><input type="radio" name="vida" value="3">3</label>
          <label class="chip"><input type="radio" name="vida" value="4">4</label>
          <label class="chip"><input type="radio" name="vida" value="5">5</label>

          <span class="pill">Deportes:</span>
          <label class="chip"><input type="radio" name="sport" value="0">0</label>
          <label class="chip"><input type="radio" name="sport" value="1">1</label>
          <label class="chip"><input type="radio" name="sport" value="2">2</label>
          <label class="chip"><input type="radio" name="sport" value="3">3</label>
          <label class="chip"><input type="radio" name="sport" value="4">4</label>
          <label class="chip"><input type="radio" name="sport" value="5">5</label>

          <span class="pill">Computadora:</span>
          <label class="chip"><input type="radio" name="comp" value="0">0</label>
          <label class="chip"><input type="radio" name="comp" value="1">1</label>
          <label class="chip"><input type="radio" name="comp" value="2">2</label>
          <label class="chip"><input type="radio" name="comp" value="3">3</label>
          <label class="chip"><input type="radio" name="comp" value="4">4</label>
          <label class="chip"><input type="radio" name="comp" value="5">5</label>

          <span class="pill">Lectura:</span>
          <label class="chip"><input type="radio" name="lect" value="0">0</label>
          <label class="chip"><input type="radio" name="lect" value="1">1</label>
          <label class="chip"><input type="radio" name="lect" value="2">2</label>
          <label class="chip"><input type="radio" name="lect" value="3">3</label>
          <label class="chip"><input type="radio" name="lect" value="4">4</label>
          <label class="chip"><input type="radio" name="lect" value="5">5</label>
        </div>

        <!-- Detalles (checkbox) -->
        <div class="col-12"><label>Detalles de actividades</label></div>
        <div class="col-12 chips">
          <!-- Conducir -->
          <span class="pill">Conducir:</span>
          <label class="chip"><input type="checkbox" name="drive_auto" value="Sí"> Auto</label>
          <label class="chip"><input type="checkbox" name="drive_bus" value="Sí"> Autobús</label>
          <label class="chip"><input type="checkbox" name="drive_moto" value="Sí"> Moto</label>
          <label class="chip"><input type="checkbox" name="drive_tren" value="Sí"> Tren</label>
          <label class="chip"><input type="checkbox" name="drive_camion" value="Sí"> Camión</label>

          <!-- Vida profesional -->
          <span class="pill">Vida profesional:</span>
          <label class="chip"><input type="checkbox" name="work_cerca" value="Sí"> Cerca</label>
          <label class="chip"><input type="checkbox" name="work_inter_cercano" value="Sí"> Intermedio y cercano</label>
          <label class="chip"><input type="checkbox" name="work_inter_laboral" value="Sí"> Intermedio laboral</label>
          <label class="chip"><input type="checkbox" name="work_lejos" value="Sí"> Lejos</label>
          <label class="chip"><input type="checkbox" name="work_inter_lejano" value="Sí"> Intermedio y lejano</label>

          <!-- Deportes -->
          <span class="pill">Deportes:</span>
          <label class="chip"><input type="checkbox" name="sport_gimnasia" value="Sí"> Gimnasia</label>
          <label class="chip"><input type="checkbox" name="sport_correr" value="Sí"> Correr y caminar</label>
          <label class="chip"><input type="checkbox" name="sport_golf" value="Sí"> Golf</label>
          <label class="chip"><input type="checkbox" name="sport_tenis" value="Sí"> Tenis</label>
          <label class="chip"><input type="checkbox" name="sport_pelota" value="Sí"> Juegos de pelota</label>
          <label class="chip"><input type="checkbox" name="sport_ciclismo" value="Sí"> Ciclismo</label>

          <!-- Computadoras -->
          <span class="pill">Computadoras:</span>
          <label class="chip"><input type="checkbox" name="comp_pc" value="Sí"> Computador</label>
          <label class="chip"><input type="checkbox" name="comp_portatil" value="Sí"> Portátil</label>
          <label class="chip"><input type="checkbox" name="comp_varios" value="Sí"> Varios dispositivos</label>
          <label class="chip"><input type="checkbox" name="comp_tableta" value="Sí"> Tableta</label>
          <label class="chip"><input type="checkbox" name="comp_phone" value="Sí"> Teléfonos inteligentes</label>

          <!-- Lectura -->
          <span class="pill">Lectura:</span>
          <label class="chip"><input type="checkbox" name="lect_libro" value="Sí"> Libro</label>
          <label class="chip"><input type="checkbox" name="lect_digital" value="Sí"> Dispositivos digitales</label>
          <label class="chip"><input type="checkbox" name="lect_periodico" value="Sí"> Periódico</label>
          <label class="chip"><input type="checkbox" name="lect_revista" value="Sí"> Revista</label>
          <label class="chip"><input type="checkbox" name="lect_varios" value="Sí"> Varios medios</label>
        </div>
      </div>
    </section>

    <!-- Medidas del marco -->
    <section class="section" style="padding-top:0">
      <h3 class="section-title">MEDIDAS DEL MARCO</h3>
      <div class="grid">
        <div class="col-3"><label>DNP Ojo izquierdo</label><input name="dnp_oi" placeholder="mm"/></div>
        <div class="col-3"><label>DNP Ojo derecho</label><input name="dnp_od" placeholder="mm"/></div>
        <div class="col-3"><label>Altura pupilar OI</label><input name="altura_pupilar_oi" placeholder="mm"/></div>
        <div class="col-3"><label>Altura pupilar OD</label><input name="altura_pupilar_od" placeholder="mm"/></div>
        <div class="col-3"><label>Altura total del cristalino</label><input name="altura_total_cristalino" placeholder="mm"/></div>
        <div class="col-3"><label>Distancia al vértice</label><input name="distancia_al_vertice" placeholder="mm"/></div>
        <div class="col-3"><label>Inclinación pantoscópica</label><input name="inclinacion_pantoscopica" placeholder="grado"/></div>
        <div class="col-3"><label>Curva del borde</label><input name="curva_del_borde" placeholder="grado"/></div>
      </div>

      <h3 class="section-title" style="margin-top:8px">GAFAS ANTERIORES</h3>
      <div class="grid">
        <div class="col-3"><label>Tipo de lente</label><input name="tipo_lente" /></div>
        <div class="col-3"><label>Proveedor</label>
          <div class="chips">
            <label class="chip"><input type="radio" name="proveedor" value="HOYA"> HOYA</label>
            <label class="chip"><input type="radio" name="proveedor" value="Otro"> Otro</label>
          </div>
        </div>
        <div class="col-3"><label>Diseño</label><input name="diseno" /></div>
        <div class="col-3"><label>Longitud del pasillo</label><input name="longitud_pasillo" /></div>
      </div>

      <h3 class="section-title" style="margin-top:8px">RECETA PREVIA</h3>
      <div class="grid">
        <div class="col-6"><div class="subcap">Ojo izquierdo</div></div>
        <div class="col-6"><div class="subcap">Ojo derecho</div></div>

        <div class="col-3"><label>Cilíndrico</label><input name="rp_cil_oi" /></div>
        <div class="col-3"><label>Esférico</label><input name="rp_esf_oi" /></div>
        <div class="col-3"><label>Eje</label><input name="rp_eje_oi" /></div>
        <div class="col-3"><label>Adición</label><input name="rp_adic_oi" /></div>

        <div class="col-3"><label>Cilíndrico</label><input name="rp_cil_od" /></div>
        <div class="col-3"><label>Esférico</label><input name="rp_esf_od" /></div>
        <div class="col-3"><label>Eje</label><input name="rp_eje_od" /></div>
        <div class="col-3"><label>Adición</label><input name="rp_adic_od" /></div>
      </div>
    </section>

    <!-- Satisfacción -->
    <section class="section" style="padding-top:0">
      <h3 class="section-title">NIVEL DE SATISFACCIÓN</h3>
      <div class="chips">
        <label class="chip"><input type="radio" name="satisfaccion" value="Muy satisfecho"> Muy satisfecho</label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Satisfecho"> Satisfecho</label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Neutral"> Neutral</label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Insatisfecho"> Insatisfecho</label>
        <label class="chip"><input type="radio" name="satisfaccion" value="Muy insatisfecho"> Muy insatisfecho</label>
      </div>
    </section>

    <!-- Acciones -->
    <div class="actions">
      <button class="btn" type="submit" id="btnSubmit">Enviar a Google Sheets</button>
      <button class="btn ghost" type="button" id="btnPrint">Imprimir / Guardar PDF</button>
      <div id="msg" class="msg"></div>
    </div>
  </form>

  <!-- Banner + pie -->
  <div class="banner">
    <img src="idmyself_actividades.jpg" alt="Actividades" />
  </div>
  <div class="page-footer">
    <img src="Imagen_Hoya.jpg" alt="HOYA" />
    <img src="Imagen_tecnologia.jpg" alt="Tecnología Japonesa para la Visión" />
  </div>
</div>

<script>
  // URL de tu Web App (implementada, acceso "Cualquiera")
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz8wYVJCHIBZPW2mzkpBkSUdGUzddeNmXcgpZmeTOfHHgiL1WcA1CMHIM8G4CaG5iMGEQ/exec";

  const f = document.getElementById('formHoya');
  const msg = document.getElementById('msg');
  const btn = document.getElementById('btnSubmit');

  const val = name => (document.querySelector(`[name="${name}"]`) || {}).value || '';
  const valR = name => (document.querySelector(`[name="${name}"]:checked`) || {}).value || '';
  const valC = name => (document.querySelector(`[name="${name}"]`)?.checked ? (document.querySelector(`[name="${name}"]`).value || 'Sí') : '');

  document.getElementById('btnPrint').addEventListener('click', () => window.print());

  f.addEventListener('submit', async (e) => {
    e.preventDefault();
    msg.textContent = "Enviando…";
    btn.disabled = true;

    // Construir payload con TODOS los encabezados de tu sheet
    const payload = {
      timestamp: new Date().toISOString(),

      sistema: val('sistema'),
      nombre: val('nombre'),
      apellidos: val('apellidos'),
      sexo: valR('sexo'),
      fecha_nac: val('fecha_nac'),

      esf_oi: val('esf_oi'),
      cil_oi: val('cil_oi'),
      eje_oi: val('eje_oi'),
      adic_oi: val('adic_oi'),
      esf_od: val('esf_od'),
      cil_od: val('cil_od'),
      eje_od: val('eje_od'),
      adic_od: val('adic_od'),

      prisma_oi: valR('prisma_oi'),
      primer_par: valR('primer_par'),

      prisma_h_oi_val: val('prisma_h_oi_val'),
      horiz_oi: valR('horiz_oi'),
      prisma_v_oi_val: val('prisma_v_oi_val'),
      vert_oi: valR('vert_oi'),
      prisma_res_oi: val('prisma_res_oi'),

      prisma_h_od_val: val('prisma_h_od_val'),
      horiz_od: valR('horiz_od'),
      prisma_v_od_val: val('prisma_v_od_val'),
      vert_od: valR('vert_od'),
      prisma_res_od: val('prisma_res_od'),

      int: valR('int'),
      ext: valR('ext'),

      tv: valR('tv'),
      compras: valR('compras'),
      drive: valR('drive'),
      vida: valR('vida'),
      sport: valR('sport'),
      comp: valR('comp'),
      lect: valR('lect'),

      drive_auto: valC('drive_auto'),
      drive_bus: valC('drive_bus'),
      drive_moto: valC('drive_moto'),
      drive_tren: valC('drive_tren'),
      drive_camion: valC('drive_camion'),

      work_cerca: valC('work_cerca'),
      work_inter_cercano: valC('work_inter_cercano'),
      work_inter_laboral: valC('work_inter_laboral'),
      work_lejos: valC('work_lejos'),
      work_inter_lejano: valC('work_inter_lejano'),

      sport_gimnasia: valC('sport_gimnasia'),
      sport_correr: valC('sport_correr'),
      sport_golf: valC('sport_golf'),
      sport_tenis: valC('sport_tenis'),
      sport_pelota: valC('sport_pelota'),
      sport_ciclismo: valC('sport_ciclismo'),

      comp_pc: valC('comp_pc'),
      comp_portatil: valC('comp_portatil'),
      comp_varios: valC('comp_varios'),
      comp_tableta: valC('comp_tableta'),
      comp_phone: valC('comp_phone'),

      lect_libro: valC('lect_libro'),
      lect_digital: valC('lect_digital'),
      lect_periodico: valC('lect_periodico'),
      lect_revista: valC('lect_revista'),
      lect_varios: valC('lect_varios'),

      dnp_oi: val('dnp_oi'),
      dnp_od: val('dnp_od'),
      altura_pupilar_oi: val('altura_pupilar_oi'),
      altura_pupilar_od: val('altura_pupilar_od'),
      altura_total_cristalino: val('altura_total_cristalino'),
      distancia_al_vertice: val('distancia_al_vertice'),
      inclinacion_pantoscopica: val('inclinacion_pantoscopica'),
      curva_del_borde: val('curva_del_borde'),

      tipo_lente: val('tipo_lente'),
      proveedor: valR('proveedor') || val('proveedor'),
      diseno: val('diseno'),
      longitud_pasillo: val('longitud_pasillo'),

      rp_cil_oi: val('rp_cil_oi'),
      rp_esf_oi: val('rp_esf_oi'),
      rp_eje_oi: val('rp_eje_oi'),
      rp_adic_oi: val('rp_adic_oi'),
      rp_cil_od: val('rp_cil_od'),
      rp_esf_od: val('rp_esf_od'),
      rp_eje_od: val('rp_eje_od'),
      rp_adic_od: val('rp_adic_od'),

      satisfaccion: valR('satisfaccion')
    };

    try{
      const body = new URLSearchParams(payload);
      const r = await fetch(SCRIPT_URL, { method:'POST', mode:'no-cors', body });
      // Con mode:no-cors no hay respuesta legible, asumimos éxito
      msg.textContent = "✅ Enviado. Revisa tu Google Sheet.";
      f.reset();
    }catch(err){
      console.error(err);
      msg.textContent = "❌ Error al enviar. Verifica la Web App (permisos e implementación).";
    }finally{
      btn.disabled = false;
    }
  });
</script>
</body>
</html>
